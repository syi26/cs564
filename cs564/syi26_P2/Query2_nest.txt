--Student ID: 9075297896

SELECT N_NAME, SUM(L_QUANTITY*(L_EXTENDEDPRICE-L_DISCOUNT)) AS TOTAL_VOLUME
FROM (
    SELECT *
    FROM SUPPLIER, CUSTOMER, PARTSUPP, ORDERS, LINEITEM
    WHERE S_SUPPKEY = PS_SUPPKEY
        AND PS_SUPPKEY = L_SUPPKEY
        AND PS_PARTKEY = L_PARTKEY
        AND C_CUSTKEY = O_CUSTKEY
        AND O_ORDERKEY = L_ORDERKEY
        AND S_NATIONKEY = C_NATIONKEY
)
JOIN NATION
ON S_NATIONKEY = N_NATIONKEY
GROUP BY N_NATIONKEY
ORDER BY N_NAME;
